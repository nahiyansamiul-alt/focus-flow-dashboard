<!DOCTYPE html>
<html>

	<head>
		<title>History API Test</title>
	</head>

	<body>
		<h1>History API Test</h1>
		<div id="output"></div>
		<script>
			async function testAPI() {
				try {
					console.log('Fetching from http://localhost:5000/api/history');
					const response = await fetch('http://localhost:5000/api/history');
					console.log('Response status:', response.status);
					const data = await response.json();
					console.log('Data received:', data);

					const grouped = {};
					data.forEach(item => {
						if (item.date && item.action === 'focus_session') {
							if (!grouped[item.date]) grouped[item.date] = [];
							grouped[item.date].push(item.duration);
						}
					});

					console.log('Grouped by date:', grouped);

					document.getElementById('output').innerHTML = `
                    <p>Total records: ${data.length}</p>
                    <p>Records with focus_session action: ${data.filter(d => d.action === 'focus_session').length}</p>
                    <pre>${JSON.stringify(grouped, null, 2)}</pre>
                    <h3>Sample records:</h3>
                    <pre>${JSON.stringify(data.slice(0, 3), null, 2)}</pre>
                `;
				} catch (error) {
					console.error('Error:', error);
					document.getElementById('output').innerHTML = `<p>Error: ${error.message}</p>`;
				}
			}

			testAPI();
		</script>
	</body>

</html>